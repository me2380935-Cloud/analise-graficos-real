 "use client";
import "./styles.css";
import { useState } from "react";

export default function PlansPage() {
  const [loadingPlan, setLoadingPlan] = useState<string | null>(null);

  // Eu escolhi preços estratégicos (conversão balanceada: atraente e lucrativa)
  // Semanal: R$ 9,90 — ideal para testar
  // Mensal:  R$24,90 — melhor custo-benefício para usuários recorrentes
  // 3 meses: R$59,90 — desconto claro (economia ~20%)
  const plans = [
    { id: "weekly", title: "Semanal", price: "R$ 9,90", bullets: ["Teste rápido", "Acesso total por 7 dias", "Suporte básico"], tag: "Mais popular" },
    { id: "monthly", title: "Mensal", price: "R$ 24,90", bullets: ["Melhor para uso contínuo", "Relatórios avançados", "Notificações"], tag: "" },
    { id: "quarterly", title: "3 Meses", price: "R$ 59,90", bullets: ["Melhor valor", "Acesso prioritário", "Histórico completo"], tag: "" },
  ];

  const buy = async (planId: string) => {
    setLoadingPlan(planId);
    try {
      // TODO: integrar com Stripe / MercadoPago: chamar /api/create-checkout-session
      // Simulação UX:
      await new Promise((r) => setTimeout(r, 900));
      alert(`Simulação: iniciando checkout do plano ${planId}`);
    } catch (err) {
      console.error(err);
      alert("Erro ao iniciar pagamento, tente novamente.");
    } finally {
      setLoadingPlan(null);
    }
  };

  return (
    <main className="plans-page">
      <section className="plans-hero">
        <div className="hero-left">
          <h1 className="hero-title">TradeVision Premium</h1>
          <p className="hero-sub">
            Desbloqueie análises ilimitadas, relatórios profissionais e atendimento prioritário — tudo pensado para traders que levam resultados a sério.
          </p>

          <div className="features">
            <div className="feature"><span className="dot green" /> Análises ilimitadas</div>
            <div className="feature"><span className="dot purple" /> Relatórios em PDF</div>
            <div className="feature"><span className="dot blue" /> Suporte prioritário</div>
          </div>
        </div>

        <div className="hero-right">
          <img
            src="/mnt/data/9135C5BD-F53C-4C95-9AF8-BC8A966F2F2F.jpeg"
            alt="TradeVision preview"
            className="hero-image"
          />
        </div>
      </section>

      <section className="plans-grid">
        {plans.map((p) => (
          <article key={p.id} className={`plan-card ${p.tag ? "popular" : ""}`}>
            {p.tag && <div className="plan-badge">{p.tag}</div>}
            <h3>{p.title}</h3>
            <p className="price">{p.price}</p>
            <ul>
              {p.bullets.map((b) => <li key={b}>{b}</li>)}
            </ul>
            <button
              className="buy-btn"
              onClick={() => buy(p.id)}
              disabled={loadingPlan === p.id}
            >
              {loadingPlan === p.id ? "Processando..." : `Assinar ${p.title}`}
            </button>
          </article>
        ))}
      </section>

      <footer className="plans-footer">
        <p>Garantia de reembolso em 7 dias • Pagamentos seguros • Suporte em PT-BR</p>
      </footer>
    </main>
  );
}
